services:
  - type: web
    name: helius-webhook-handler
    env: python
    buildCommand: pip install --upgrade pip && pip install -r requirements.txt
    startCommand: python deploy/app.py
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.11
      - key: PORT
        value: 10000
      - key: PYTHONPATH
        value: .
      - key: POSTGRES_HOST
        value: ""  # Set this to your actual PostgreSQL host
      - key: POSTGRES_PORT
        value: "5432"
      - key: POSTGRES_DB
        value: "trading_system"
      - key: POSTGRES_USER
        value: ""  # Set this to your actual PostgreSQL user
      - key: POSTGRES_PASSWORD
        value: ""  # Set this to your actual PostgreSQL password
      - key: POSTGRES_SSL_MODE
        value: "require"
      - key: DB_FORCE_IPV4
        value: "true"
      - key: DB_TRY_SUPABASE_POOLER
        value: "1"  # Use Supabase pooler on 6543 with hostname (SNI required)
      - key: POSTGRES_HOSTADDR
        value: ""    # Leave empty for Supabase to avoid IP-based pooler connection